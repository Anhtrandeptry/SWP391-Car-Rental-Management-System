<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <title>Car Listings</title>
    <link rel="stylesheet" th:href="@{/css/styles.css}"/>
</head>
<body>

<div class="container">

    <!-- HEADER -->
    <div class="page-header">
        <div class="logo">CRMS</div>

        <!-- LOGIN BUTTON -->
        <div class="header-actions">
            <a th:href="@{/auth/login}" class="login-btn">Đăng nhập</a>
        </div>
    </div>

    <!-- SEARCH -->
    <div class="search-wrapper">
        <h2>Tìm xe tự lái</h2>

        <form th:action="@{/public/cars}" method="get" class="search-box">
            <input type="text"
                   name="name"
                   placeholder="Chọn địa điểm / tên xe"
                   th:value="${name}"/>

            <button type="submit">TÌM XE</button>
            <a th:href="@{/public/cars}" class="clear-btn">XÓA</a>
        </form>
    </div>

    <!-- FILTER -->
    <form th:action="@{/public/cars}" method="get" class="filter-box">

        <select name="seats">
            <option value="">Số chỗ</option>
            <option th:each="s : ${seatsList}"
                    th:value="${s}"
                    th:text="${s}"
                    th:selected="${s == seats}">
            </option>
        </select>

        <select name="brand">
            <option value="">Hãng xe</option>
            <option th:each="b : ${brands}"
                    th:value="${b}"
                    th:text="${b}"
                    th:selected="${b == brand}">
            </option>
        </select>

        <select name="carType">
            <option value="">Loại xe</option>
            <option th:each="t : ${carTypes}"
                    th:value="${t}"
                    th:text="${t}"
                    th:selected="${t == carType}">
            </option>
        </select>

        <select name="fuelType">
            <option value="">Nhiên liệu</option>
            <option th:each="f : ${fuelTypes}"
                    th:value="${f}"
                    th:text="${f}"
                    th:selected="${f == fuelType}">
            </option>
        </select>

        <input type="text"
               name="location"
               placeholder="Địa điểm"
               th:value="${location}"/>

        <div class="filter-actions">
            <button type="submit">LỌC</button>

            <!-- RESET FILTER -->
            <a th:href="@{/public/cars}" class="reset-filter-btn">
                XÓA LỌC
            </a>
        </div>
    </form>

    <!-- RESULT -->
    <div th:if="${cars.empty}">
        <p>Không tìm thấy xe.</p>
    </div>

    <div class="car-list" th:if="${!cars.empty}">
        <div class="car-item" th:each="car : ${cars}">
            <a th:href="@{/public/cars/{id}(id=${car.id})}" class="car-link">

                <img th:if="${car.mainImageUrl != null}"
                     th:src="@{${car.mainImageUrl}}"/>

                <img th:unless="${car.mainImageUrl != null}"
                     src="/images/placeholder-car.png"/>

                <div class="car-meta">
                    <h3 th:text="${car.name}"></h3>
                    <p th:text="${car.brand} + ' - ' + ${car.model}"></p>
                    <p th:text="${car.location}"></p>

                    <p class="car-price"
                       th:text="${#numbers.formatDecimal(car.pricePerDay, 1, 'COMMA', 0, 'POINT')} + 'K/ngày'">
                    </p>

                    <p class="rating">
                        ⭐ <span th:text="${car.averageRating}"></span>
                    </p>
                </div>

            </a>
        </div>
    </div>

</div>

</body>
</html>
